<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Detail Table</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
  <h1>Details for Master: <span th:text="${master.name}"></span></h1>
  <a href="/master-detail" class="btn btn-secondary mb-3">Back to Masters</a>

  <!-- Форма добавления новой детали -->
  <div class="card mb-4">
    <div class="card-header">
      <h5>Add New Detail</h5>
    </div>
    <div class="card-body">
      <form th:action="@{/master-detail/master/{masterId}/detail(masterId=${master.id})}"
            method="post" th:object="${newDetail}">
        <div class="row">
          <div class="col-md-3">
            <input type="text" th:field="*{itemName}" class="form-control" placeholder="Item Name" required>
          </div>
          <div class="col-md-2">
            <input type="number" th:field="*{quantity}" class="form-control" placeholder="Quantity" min="1" required>
          </div>
          <div class="col-md-2">
            <input type="number" th:field="*{price}" class="form-control" placeholder="Price" step="0.01" min="0" required>
          </div>
          <div class="col-md-2">
            <button type="submit" class="btn btn-primary">Add</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Таблица деталей -->
  <table class="table table-striped">
    <thead>
    <tr>
      <th>ID</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Total</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="detail : ${details}">
      <td th:text="${detail.id}"></td>
      <td th:text="${detail.itemName}"></td>
      <td th:text="${detail.quantity}"></td>
      <td th:text="${'$' + #numbers.formatDecimal(detail.price, 1, 2)}"></td>
      <td th:text="${'$' + #numbers.formatDecimal(detail.total, 1, 2)}"></td>
      <td>
        <form th:action="@{/master-detail/detail/{id}/delete(id=${detail.id})}"
              method="post" style="display: inline;">
          <button type="submit" class="btn btn-danger btn-sm"
                  onclick="return confirm('Delete this detail?')">Delete</button>
        </form>
      </td>
    </tr>
    </tbody>
  </table>
</div>
</body>
</html>